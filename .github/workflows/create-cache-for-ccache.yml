name: Create Cache for ccache

on:
  push:
    branches:
      - develop

  # 手動トリガーを許可
  workflow_dispatch:

jobs:
  clang_without_pch_japanese:
    name: Japanese version with clang (without using pre-compiled headers)
    uses: ./.github/workflows/build-with-autotools.yml
    with:
      cxx: clang++-15
      cxx-flags: "-pipe -O3 -Werror -Wall -Wextra -Wno-unused-const-variable -Wno-invalid-source-encoding -stdlib=libc++ -std=c++20"
      configure-opts: "--disable-pch"
      use-ccache: true

  gcc_japanese:
    name: Japanese version with gcc
    uses: ./.github/workflows/build-with-autotools.yml
    with:
      cxx: g++-13
      cxx-flags: "-pipe -O3 -Werror -Wall -Wextra -std=c++20"
      use-ccache: true

  gcc_english:
    name: English version with gcc
    uses: ./.github/workflows/build-with-autotools.yml
    with:
      cxx: g++-13
      cxx-flags: "-pipe -O3 -Werror -Wall -Wextra -std=c++20"
      configure-opts: "--disable-japanese"
      distcheck: true
      use-ccache: true
